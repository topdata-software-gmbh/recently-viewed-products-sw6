"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["custom_plugins_recently-viewed-products-sw6_src_Resources_app_storefront_src_plugin_recent-pr-62fbbe"],{951:(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});class s{get(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/json",s=this._createPreparedRequest("GET",e,r);return this._sendRequest(s,null,t)}post(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";s=this._getContentType(t,s);let n=this._createPreparedRequest("POST",e,s);return this._sendRequest(n,t,r)}delete(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";s=this._getContentType(t,s);let n=this._createPreparedRequest("DELETE",e,s);return this._sendRequest(n,t,r)}patch(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";s=this._getContentType(t,s);let n=this._createPreparedRequest("PATCH",e,s);return this._sendRequest(n,t,r)}abort(){if(this._request)return this._request.abort()}setErrorHandlingInternal(e){this._errorHandlingInternal=e}_registerOnLoaded(e,t){t&&(!0===this._errorHandlingInternal?(e.addEventListener("load",()=>{t(e.responseText,e)}),e.addEventListener("abort",()=>{console.warn("the request to ".concat(e.responseURL," was aborted"))}),e.addEventListener("error",()=>{console.warn("the request to ".concat(e.responseURL," failed with status ").concat(e.status))}),e.addEventListener("timeout",()=>{console.warn("the request to ".concat(e.responseURL," timed out"))})):e.addEventListener("loadend",()=>{t(e.responseText,e)}))}_sendRequest(e,t,r){return this._registerOnLoaded(e,r),e.send(t),e}_getContentType(e,t){return e instanceof FormData&&(t=!1),t}_createPreparedRequest(e,t,r){return this._request=new XMLHttpRequest,this._request.open(e,t),this._request.setRequestHeader("X-Requested-With","XMLHttpRequest"),r&&this._request.setRequestHeader("Content-type",r),this._request}constructor(){this._request=null,this._errorHandlingInternal=!1}}class n{static iterate(e,t){if(e instanceof Map||Array.isArray(e))return e.forEach(t);if(e instanceof FormData){for(var r of e.entries())t(r[1],r[0]);return}if(e instanceof NodeList)return e.forEach(t);if(e instanceof HTMLCollection)return Array.from(e).forEach(t);if(e instanceof Object)return Object.keys(e).forEach(r=>{t(e[r],r)});throw Error("The element type ".concat(typeof e," is not iterable!"))}}let i="loader",o={BEFORE:"before",INNER:"inner"};class a{create(){if(!this.exists()){if(this.position===o.INNER){this.parent.innerHTML=a.getTemplate();return}this.parent.insertAdjacentHTML(this._getPosition(),a.getTemplate())}}remove(){let e=this.parent.querySelectorAll(".".concat(i));n.iterate(e,e=>e.remove())}exists(){return this.parent.querySelectorAll(".".concat(i)).length>0}_getPosition(){return this.position===o.BEFORE?"afterbegin":"beforeend"}static getTemplate(){return'<div class="'.concat(i,'" role="status">\n                    <span class="').concat("visually-hidden",'">Loading...</span>\n                </div>')}static SELECTOR_CLASS(){return i}constructor(e,t=o.BEFORE){this.parent=e instanceof Element?e:document.body.querySelector(e),this.position=t}}let l="element-loader-backdrop";class c extends a{static create(e){e.classList.add("has-element-loader"),c.exists(e)||(c.appendLoader(e),setTimeout(()=>{let t=e.querySelector(".".concat(l));t&&t.classList.add("element-loader-backdrop-open")},1))}static remove(e){e.classList.remove("has-element-loader");let t=e.querySelector(".".concat(l));t&&t.remove()}static exists(e){return e.querySelectorAll(".".concat(l)).length>0}static getTemplate(){return'\n        <div class="'.concat(l,'">\n            <div class="loader" role="status">\n                <span class="').concat("visually-hidden",'">Loading...</span>\n            </div>\n        </div>\n        ')}static appendLoader(e){e.insertAdjacentHTML("beforeend",c.getTemplate())}}class d extends window.PluginBaseClass{init(){this._client=new s,this.fetch()}fetch(){if(!this.options.id)return;c.create(this.el);let e=window.router["frontend.recent-product-slider.content"]+"?elementId="+this.options.id;this.options.excludeProductId&&(e+="&excludeProductId="+this.options.excludeProductId),this._client.get(e,e=>{if(c.remove(this.el),!e||0===e.trim().length){var t;let e=(t=this.el.closest(".product-detail"))===null||void 0===t?void 0:t.querySelector(".recently-viewed-product-bar");e&&e.remove(),this.el.remove();return}this.renderProductSlider(e)})}renderProductSlider(e){this.el.innerHTML=e,window.PluginManager.initializePlugin("ProductSlider",".product-slider")}}}}]);